%clear all
clc 

% Zestaw 1

%x = [0	0.500000000000000	1	1.50000000000000	2	2.50000000000000	3	3.50000000000000	4];
%y = [1	1.01972784447234	0.425324148260754	0.00750249000360903	0.255653805962070	0.882134329567183	1.10129029471023	0.403119026653685	-0.902302529116542];


% Zestaw 2

x = [0	0.200000000000000	0.400000000000000	0.600000000000000	0.800000000000000	1	1.20000000000000	1.40000000000000	1.60000000000000	1.80000000000000	2	2.20000000000000	2.40000000000000	2.60000000000000	2.80000000000000	3	3.20000000000000	3.40000000000000	3.60000000000000	3.80000000000000	4];
y = [1	1.11973032479795	1.08612505165582	0.927000227871709	0.688156568598234	0.425324148260754	0.194645370425981	0.0432273893198020	0.00127882724675199	0.0770892145440482	0.255653805962070	0.501163533841171	0.762962163990597	0.984018043121841	1.11055402866615	1.10129029471023	0.934810775330613	0.613856388322994	0.165830871237402				-0.360598048360463	-0.902302529116542];

% Zmieniaæ wzór, prawostronna, lewostronna, œrodkowa.

F = @(x) sin(x) + cos(2*x);
FP = @(x) cos(x) - 2*sin(2*x);

FW3PC = @(i) (y(i+1) - y(i-1)) / (2*(x(i) - x(i-1)));
FW3PP = @(i) (-3*y(i)+4*y(i+1)-y(i+2)) / (2*(x(i+1)-x(i)));
FW3PL = @(i) (y(i-2)-4*y(i-1)+3*y(i)) / (2*(x(i) - x(i-1)));

n = size(x, 2);

% Sposob 1
yp_1 = zeros(1, n);
for i = 1:n
    if i < n/2
        yp_1(i) = FW3PP(i);
    elseif i >= n/2
        yp_1(i) = FW3PL(i);
    end
end

% Sposob 2
yp_2 = zeros(1, n);
for i = 1:n
    if i == 1
        yp_2(i) = FW3PP(i);
    elseif i > n-2
        yp_2(i) = FW3PL(i);
    else
        yp_2(i) = FW3PC(i);
    end
end


% Nie wolno pochodnych dla danych dyskretnych ci¹gle tego samego wzoru.
% Je¿eli s¹ wzory wiêcej punktowe to nie bêdziemy mieli wystarczaj¹cych
% punktów.
subplot(2, 1, 1)
plot(x, yp_1);
hold on
plot(x, FP(x));
title("Sposob 1")

subplot(2, 1, 2)
plot(x, yp_2);
hold on
plot(x, FP(x));
title("Sposob 2")


d = FP(x);
n = size(x, 2);
mse_1 = (1/n) * sum((d-yp_1).^2)
mse_2 = (1/n) * sum((d-yp_2).^2)
